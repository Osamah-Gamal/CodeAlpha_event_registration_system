<%
layout = 'layouts/admin-layout';
pageTitle = 'Event Management';
currentPage = 'events';
%>

<!-- Create Event Form -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">🆕 Create New Event</h5>
    </div>
    <div class="card-body">
        <form action="/admin/events/create" method="POST">
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="title" class="form-label">Event Title *</label>
                        <input type="text" class="form-control" id="title" name="title" required 
                               placeholder="Enter event title">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="date" class="form-label">Event Date *</label>
                        <input type="date" class="form-control" id="date" name="date" required>
                    </div>
                </div>
            </div>
            <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <textarea class="form-control" id="description" name="description" rows="3"
                          placeholder="Describe the event..."></textarea>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="location" class="form-label">Location *</label>
                        <input type="text" class="form-control" id="location" name="location" required
                               placeholder="Event location">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="max_attendees" class="form-label">Max Attendees</label>
                        <input type="number" class="form-control" id="max_attendees" name="max_attendees"
                               placeholder="Leave empty for unlimited">
                    </div>
                </div>
            </div>
            <button type="submit" class="btn btn-success">➕ Create Event</button>
        </form>
    </div>
</div>

<!-- Events List -->
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">📅 All Events</h5>
        <span class="badge bg-primary"><%= events.length %> events</span>
    </div>
    <div class="card-body">
        <% if (events && events.length > 0) { %>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Event Details</th>
                        <th>Date</th>
                        <th>Location</th>
                        <th>Capacity</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% events.forEach(function(event) { %>
                    <tr>
                        <td><strong>#<%= event.id %></strong></td>
                        <td>
                            <strong><%= event.title %></strong>
                            <% if (event.description) { %>
                            <br><small class="text-muted"><%= event.description %></small>
                            <% } %>
                        </td>
                        <td>
                            <strong><%= new Date(event.date).toLocaleDateString() %></strong>
                        </td>
                        <td><%= event.location %></td>
                        <td>
                            <span class="badge bg-<%= event.max_attendees ? 'info' : 'secondary' %>">
                                <%= event.max_attendees || 'Unlimited' %>
                            </span>
                        </td>
                        <td>
                            <form action="/admin/events/<%= event.id %>/delete" method="POST" class="d-inline">
                                <button type="submit" class="btn btn-danger btn-sm" 
                                        onclick="return confirm('Are you sure you want to delete event: <%= event.title %>?')">
                                    🗑️ Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>
        <% } else { %>
        <div class="text-center py-4">
            <i class="fs-1 text-muted">📅</i>
            <h5 class="text-muted">No events found</h5>
            <p class="text-muted">Create your first event using the form above.</p>
        </div>
        <% } %>
    </div>
</div>